fixes CVE-2017-1000249: file: stack based buffer overflow

http://seclists.org/oss-sec/2017/q3/397
